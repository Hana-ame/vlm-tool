<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>脚本加载管理</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; padding: 20px; max-width: 600px; margin: 0 auto; color: #333; }
        .list-container { margin-top: 20px; border: 1px solid #eee; border-radius: 8px; overflow: hidden; }
        
        /* 全区域点击的核心：将 label 设置为 display: flex */
        .script-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background 0.2s;
        }
        .script-item:last-child { border-bottom: none; }
        .script-item:hover { background-color: #f9f9f9; }
        
        .script-info { flex-grow: 1; margin-left: 15px; }
        .script-name { font-weight: bold; display: block; margin-bottom: 2px; }
        .script-desc { font-size: 0.85em; color: #666; display: block; }
        .script-url { font-size: 0.75em; color: #999; display: block; margin-top: 4px; font-family: monospace; }

        .add-form { margin-top: 30px; padding: 20px; background: #f4f7f6; border-radius: 8px; }
        .add-form input { display: block; width: 100%; margin-bottom: 10px; padding: 8px; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
        .add-form button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>脚本管理</h1>
    
    <div id="scriptList" class="list-container">
        <!-- 列表由 JS 渲染 -->
    </div>

    <div class="add-form">
        <h3>添加新脚本</h3>
        <input type="text" id="newName" placeholder="名称">
        <input type="text" id="newDesc" placeholder="描述">
        <input type="text" id="newUrl" placeholder="JS 脚本 URL">
        <button onclick="addScript()">保存到列表</button>
    </div>

    <script>
        const STORAGE_KEY = 'custom_loader_scripts';

        // 初始化数据
        let scripts = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [
            { name: "tampermonkey polyfill", describe: "不选会bug，忘记加代码里了，就加在这里了", url: "https://config.810114.xyz/exhentai/gm-polyfill.js", enabled: true },
            { name: "聊天室", describe: "右下角的蓝色气泡", url: "https://inline-chat.moonchan.xyz/loader.js", enabled: true },
            { name: "EhSyringe", describe: "E 站注射器，将中文翻译注入到 E 站体内。包含全站 UI 翻译和超过 37000 条标签翻译，标签数据库持续更新中。", url: "https://config.810114.xyz/exhentai/EhSyringe.user.js", enabled: false },            
            // { name: "ComicRead", describe: "为漫画站增加双页阅读、翻译等优化体验的增强功能。百合会（记录阅读历史、自动签到等）、百合会新站、E-Hentai（关联外站、快捷收藏、标签染色、识别广告页等）、nhentai（彻底屏蔽漫画、无限滚动）、Yurifans（自动签到）、拷贝漫画(copymanga)（显示最后阅读记录、解锁隐藏漫画）、再漫画、漫画柜(manhuagui)、动漫屋(dm5)、mangabz、komiic、無限動漫、绅士漫画(wnacg)、禁漫天堂、NoyAcg、熱辣漫畫、hanime1、hitomi、hdoujin、SchaleNetwork、nude-moon、HentaiZap、IMHentai、HentaiEra、HentaiEnvy、MangaDex、welovemanga、kemono、nekohouse、Pixiv、明日方舟泰拉记事社、最前線、Tachidesk、LANraragi", url: "https://config.810114.xyz/exhentai/ComicRead.user.js", enabled: false },
            // { name: "Ehentai画廊收藏助手", describe: "e-hentai和exhentai画廊页面直接管理收藏和种子下载", url: "https://config.810114.xyz/exhentai/Ehentai%E7%94%BB%E5%BB%8A%E6%94%B6%E8%97%8F%E5%8A%A9%E6%89%8B.user.js", enabled: false },
            // { name: "Ehentai画廊收藏助手 (BennyChou 自用修改版)", describe: "Ehentai画廊收藏助手的修改版，詳細資訊請參考倉庫描述 https://github.com/bennyz327/Ehentai-gallery-script", url: "https://config.810114.xyz/exhentai/Ehentai%E7%94%BB%E5%BB%8A%E6%94%B6%E8%97%8F%E5%8A%A9%E6%89%8B%20%28BennyChou%20%E8%87%AA%E7%94%A8%E4%BF%AE%E6%94%B9%E7%89%88%29.user.js", enabled: false },
            // { name: "解锁 Hath Perks", describe: "解锁 Hath Perks 及增加一些小工具", url: "https://config.810114.xyz/exhentai/Unlock%20Hath%20Perks.user.js", enabled: false },
            // { name: "东方永页机", describe: "终极自动翻页 - 加载并拼接下一分页内容至当前页尾，智能适配任意网页", url: "https://config.810114.xyz/exhentai/Pagetual.user.js", enabled: false },
            // { name: "ExResurrect", describe: "Resurrect E/Ex gallery listings", url: "https://config.810114.xyz/exhentai/ExResurrect.user.js", enabled: false },
            // { name: "find panda", describe: "check panda.chaika.moe for related galleries when searching", url: "https://config.810114.xyz/exhentai/find%20panda.user.js", enabled: false },
            // { name: "Sadpanda Save/Export All Favorites", describe: "Load all favorites to the page and save it, export as JSON data or just copy the textbox contents. Works on exhentai and e-hentai.", url: "https://config.810114.xyz/exhentai/Sadpanda%20SaveExport%20All%20Favorites.user.js", enabled: false },
            { name: "E-Hentai Downloader", describe: "Download E-Hentai archive as zip file", url: "https://config.810114.xyz/exhentai/E-Hentai%20Downloader.user.js", enabled: false },
        ];

        function render() {
            const container = document.getElementById('scriptList');
            container.innerHTML = scripts.map((s, index) => `
                <label class="script-item">
                    <input type="checkbox" ${s.enabled ? 'checked' : ''} onchange="toggleScript(${index})">
                    <div class="script-info">
                        <span class="script-name">${s.name}</span>
                        <span class="script-desc">${s.describe}</span>
                        <span class="script-url">${s.url}</span>
                    </div>
                </label>
            `).join('');
            localStorage.setItem(STORAGE_KEY, JSON.stringify(scripts));
        }

        function addScript() {
            const name = document.getElementById('newName').value;
            const desc = document.getElementById('newDesc').value;
            const url = document.getElementById('newUrl').value;
            if (name && url) {
                scripts.push({ name, describe: desc, url, enabled: true });
                render();
                document.getElementById('newName').value = '';
                document.getElementById('newDesc').value = '';
                document.getElementById('newUrl').value = '';
            }
        }

        function toggleScript(index) {
            scripts[index].enabled = !scripts[index].enabled;
            render();
        }

        render();
    </script>
</body>
</html>